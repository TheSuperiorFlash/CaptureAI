# Cloudflare Workers Configuration
# Learn more: https://developers.cloudflare.com/workers/wrangler/configuration/

name = "api"
main = "src/index.js"
compatibility_date = "2024-01-01"

# Account ID - Get from: https://dash.cloudflare.com/ (right sidebar)
account_id = "e411f43b15c9122c0056a08f727eef15"

# Workers AI Gateway binding
# This automatically connects to your AI Gateway
[ai]
binding = "AI"

# D1 Database binding
# Creates a SQLite database at the edge
[[d1_databases]]
binding = "DB"
database_name = "captureai-db"
database_id = "8056a7db-be99-4c64-8316-daf6c5c9b48f"  # Created when you run: wrangler d1 create captureai-db

# Durable Objects binding for distributed rate limiting
[[durable_objects.bindings]]
name = "RATE_LIMITER"
class_name = "RateLimiterDO"
script_name = "api"

# Durable Objects migrations
[[migrations]]
tag = "v1"
new_sqlite_classes = ["RateLimiterDO"]

# Environment Variables (Secrets)
# Set these with: wrangler secret put SECRET_NAME
[vars]
# Public variables (not sensitive)
CLOUDFLARE_ACCOUNT_ID = "e411f43b15c9122c0056a08f727eef15"
CLOUDFLARE_GATEWAY_NAME = "captureai-gateway"
FREE_TIER_DAILY_LIMIT = "10"
PRO_TIER_RATE_LIMIT_PER_MINUTE = "60"  # 60 requests per minute for Pro tier
EXTENSION_URL = "https://captureai.dev"
# Chrome Extension IDs - Comma-separated list of allowed extension IDs
# First ID: Production extension from Chrome Web Store
# Second ID: Development/unpacked extension for testing
CHROME_EXTENSION_IDS = "idpdleplccjjbmdmjkpmmkecmoeomnjd,pnlbkbjpefcjfaidkmickcaicecbkdio"

# Secrets - Set with: wrangler secret put SECRET_NAME
# Required secrets:
#   wrangler secret put STRIPE_SECRET_KEY
#   wrangler secret put STRIPE_WEBHOOK_SECRET
#   wrangler secret put STRIPE_PRICE_PRO
#   wrangler secret put RESEND_API_KEY
#   wrangler secret put FROM_EMAIL
# Recommended FROM_EMAIL format: CaptureAI <license@mail.captureai.dev>
# Note: Avoid "noreply" addresses for better deliverability